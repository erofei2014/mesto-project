(()=>{"use strict";var t={d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{Ag:()=>$,Md:()=>S,bi:()=>j,Py:()=>k,B1:()=>E,e$:()=>q,A3:()=>A,$L:()=>C,IR:()=>L,$j:()=>B,H2:()=>U,et:()=>x,EH:()=>P,px:()=>M,jQ:()=>H,Ii:()=>D,li:()=>T,a7:()=>O});var e=function(t,e,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(o.inputErrorClass),r.classList.remove(o.errorClass),r.textContent=""},o=function(t,o){var n=Array.from(t.querySelectorAll(o.inputSelector));n.forEach((function(r){r.setCustomValidity(""),e(t,r,o)}));var c=t.querySelector(o.submitButtonSelector);r(n,c,o)},r=function(t,e,o){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(o.inactiveButtonClass)):(e.disabled=!0,e.classList.add(o.inactiveButtonClass))};function n(t){t.classList.add("popup_opened"),S.addEventListener("keydown",u),t.addEventListener("click",i)}function c(t){t.classList.remove("popup_opened"),S.removeEventListener("keydown",u),t.removeEventListener("click",i)}function i(t){t.target.classList.contains("popup")&&c(t.target)}function u(t){"Escape"===t.key&&P.forEach((function(t){c(t)}))}function a(t,e,o,r,c,i){var u=E.querySelector(".photo-grid__photo-card").cloneNode(!0);return u.querySelector(".photo-grid__photo").setAttribute("src",e),u.querySelector(".photo-grid__photo").setAttribute("alt",t),u.querySelector(".photo-grid__caption-text").textContent=t,u.querySelector(".photo-grid__like-button").addEventListener("click",(function(t){return t.target.classList.toggle("photo-grid__like-button_active")})),u.querySelector(".photo-grid__delete-button").addEventListener("click",(function(t){return t.target.closest(".photo-grid__photo-card").remove()})),u.querySelector(".photo-grid__photo").addEventListener("click",(function(t){L.setAttribute("src",t.target.getAttribute("src")),L.setAttribute("alt",t.target.getAttribute("alt")),A.textContent=t.target.getAttribute("alt"),n(C)})),function(t,e,o,r){t===e&&(o.querySelector(".photo-grid__delete-button").classList.add("photo-grid__delete-button_active"),o.querySelector(".photo-grid__delete-button").addEventListener("click",(function(t){_(r)})))}(o,r,u,c),s(i,u),function(t,e,o){Array.from(t).some((function(t){return t._id===e}))?o.querySelector(".photo-grid__like-button").classList.add("photo-grid__like-button_active"):o.querySelector(".photo-grid__like-button").classList.remove("photo-grid__like-button_active")}(i,r,u),u.querySelector(".photo-grid__like-button").addEventListener("click",(function(t){t.target.classList.contains("photo-grid__like-button_active")?d(c,u):f(c,u)})),u}function s(t,e){var o=t.length;e.querySelector(".photo-grid__likes-count").textContent=o}var l={baseUrl:"https://nomoreparties.co/v1/plus-cohort-27",headers:{authorization:"ba4ab074-000e-4a51-b901-da38460be3f2","Content-Type":"application/json"}},p="ebe4e15c5c59c55cbdd9d2ab",_=function(t){return fetch("".concat(l.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:l.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))},d=function(t,e){return fetch("".concat(l.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:l.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){s(t.likes,e)})).catch((function(t){console.log(t)}))},f=function(t,e){return fetch("".concat(l.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:l.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){s(t.likes,e)})).catch((function(t){console.log(t)}))};function h(t,e,o,r){t.value=o.textContent,e.value=r.textContent}function m(t){document.querySelector(".popup__submit-button-user-data").textContent=t?"Сохранение...":"Сохранить"}function v(t,e){H.textContent=t,M.textContent=e}function b(t){$.style.background="center / cover no-repeat url('".concat(t,"')")}var y,S=document.querySelector(".page"),g=S.querySelector(".content"),q=S.querySelector(".popup__item_input_picture-title"),k=S.querySelector(".popup__item_input_picture-link"),E=S.querySelector("#photo-card-template").content,C=S.querySelector(".popup__picture-form"),L=C.querySelector(".popup__picture-element"),A=C.querySelector(".popup__picture-caption"),j=g.querySelector(".photo-grid"),P=S.querySelectorAll(".popup"),x=S.querySelector(".popup__user-data"),B=S.querySelector(".popup__add-picture"),U=S.querySelector(".popup__user-avatar"),O=x.querySelector(".popup__item_input_username"),T=x.querySelector(".popup__item_input_occupation"),D=U.querySelector(".popup__item_input_avatar-link"),w=g.querySelector(".profile__info"),H=w.querySelector(".profile__username"),M=w.querySelector(".profile__occupation"),N=S.querySelectorAll(".popup__toggle"),J=g.querySelector(".profile__edit-button"),V=g.querySelector(".profile__add-button"),$=g.querySelector(".profile__avatar");J.addEventListener("click",(function(){n(x),h(O,T,H,M),o(x,{formSelector:".popup__form",fieldsetSelector:".popup__fieldset",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__item_type_error",errorClass:"popup__input-error_active"})})),V.addEventListener("click",(function(){q.value="",k.value="",n(B),o(B,{formSelector:".popup__form",fieldsetSelector:".popup__fieldset",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__item_type_error",errorClass:"popup__input-error_active"})})),$.addEventListener("click",(function(){D.value="",n(U),o(U,{formSelector:".popup__form",fieldsetSelector:".popup__fieldset",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__item_type_error",errorClass:"popup__input-error_active"})})),N.forEach((function(t){t.addEventListener("click",(function(t){return c(t.target.closest(".popup"))}))})),x.addEventListener("submit",(function(t){t.preventDefault();var e=O.value,o=T.value;H.textContent=e,M.textContent=o,h(O,T,H,M),m(!0),fetch("".concat(l.baseUrl,"/users/me"),{method:"PATCH",headers:l.headers,body:JSON.stringify({name:O.value,about:T.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){v(t.name,t.about)})).catch((function(t){console.log(t)})).finally((function(){m(!1)})),c(x)})),B.addEventListener("submit",(function(t){t.preventDefault(),m(!0),fetch("".concat(l.baseUrl,"/cards"),{method:"POST",headers:l.headers,body:JSON.stringify({name:q.value,link:k.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){!function(t,e,o,r,n,c){var i=a(t,e,o,r,n,c);j.prepend(i)}(t.name,t.link,t.owner._id,p,t._id,t.likes)})).catch((function(t){console.log(t)})).finally((function(){m(!1)})),c(B),t.target.reset()})),U.addEventListener("submit",(function(t){t.preventDefault(),m(!0),fetch("".concat(l.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:l.headers,body:JSON.stringify({avatar:D.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){b(t.avatar)})).catch((function(t){console.log(t)})).finally((function(){m(!1)})),c(U)})),y={formSelector:".popup__form",fieldsetSelector:".popup__fieldset",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__item_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(y.formSelector)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),Array.from(t.querySelectorAll(y.fieldsetSelector)).forEach((function(t){!function(t,o){var n=Array.from(t.querySelectorAll(o.inputSelector)),c=t.querySelector(o.submitButtonSelector);r(n,c,o),n.forEach((function(i){i.addEventListener("input",(function(){!function(t,o,r){o.validity.patternMismatch?o.setCustomValidity(o.dataset.errorMessage):o.setCustomValidity(""),o.validity.valid?e(t,o,r):function(t,e,o,r){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r.inputErrorClass),n.textContent=o,n.classList.add(r.errorClass)}(t,o,o.validationMessage,r)}(t,i,o),r(n,c,o)}))}))}(t,y)}))})),fetch("".concat(l.baseUrl,"/users/me"),{headers:l.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){v(t.name,t.about),b(t.avatar)})).catch((function(t){console.log(t)})),fetch("".concat(l.baseUrl,"/cards"),{headers:l.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){t.forEach((function(t){!function(t,e,o,r,n,c){var i=a(t,e,o,r,n,c);j.append(i)}(t.name,t.link,t.owner._id,p,t._id,t.likes)}))})).catch((function(t){console.log(t)}))})();